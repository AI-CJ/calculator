/* Onyx/Terracotta design system */
:root {
  /* Onyx neutrals */
  --onyx-950: #0b0d0e;
  --onyx-900: #0f1113;
  --onyx-850: #14171a;
  --onyx-800: #191d21;
  --onyx-750: #1f2429;
  --onyx-700: #262c32;
  --onyx-650: #2c333a;
  --onyx-600: #333b43;
  --onyx-500: #3e4852;

  /* Terracotta accents */
  --terra-300: #f2a089;
  --terra-400: #ea8c74;
  --terra-500: #e07a5f; /* primary */
  --terra-600: #cf6a4f;
  --terra-700: #b85c3d;
  --terra-800: #9e4c33;

  /* Page background (subtle onyx with terracotta glow) */
  --page-bg: var(--onyx-900);
  --page-accent-1: #221511;  /* warm shadow */
  --page-accent-2: #1a110e;

  /* Calculator (onyx) */
  --calc-bg-1: var(--onyx-900);
  --calc-bg-2: var(--onyx-850);
  --calc-border: var(--onyx-700);

  /* Display window */
  --display-bg: var(--onyx-800);
  --display-border: var(--onyx-650);
  --display-glow: rgba(224, 122, 95, 0.09); /* terracotta haze */

  /* Keys */
  --key-bg: var(--onyx-800);           /* digits */
  --key-border: var(--onyx-650);
  --key-hover: var(--onyx-750);

  --mem-bg: var(--onyx-800);           /* memory */
  --mem-border: var(--onyx-600);
  --mem-hover: var(--onyx-750);

  --util-bg: var(--onyx-800);          /* ± and % */
  --util-border: var(--onyx-600);
  --util-hover: var(--onyx-750);

  --op-bg: #2b1f1b;                    /* terracotta-tinted dark */
  --op-border: #53352b;
  --op-hover: #382720;
  --op-text: #ffe7df;

  --clear-bg: #2a1b14;                 /* rich terracotta tint */
  --clear-border: #6a3a29;
  --clear-hover: #3a251c;
  --clear-text: #ffceb9;

  --equals-grad-1: var(--terra-500);
  --equals-grad-2: var(--terra-700);

  /* Shared */
  --text: #eef2f7;
  --muted: #a8b3c7;
  --border: var(--calc-border);
  --radius: 16px;
  --gap: 10px;
  --focus: 0 0 0 3px rgba(224, 122, 95, 0.55); /* terracotta ring */
  --lift: 0 10px 18px rgba(0,0,0,0.22);
  --shadow-1: 0 12px 28px rgba(0,0,0,0.30);
  --shadow-2: 0 8px 22px rgba(0,0,0,0.22);
}

/* Optional light scheme — calculator remains onyx; page softens a bit */
@media (prefers-color-scheme: light) {
  :root {
    --page-bg: #f3f4f6;
    --page-accent-1: #f6e9e4;
    --page-accent-2: #efe4df;
    --shadow-1: 0 12px 28px rgba(0,0,0,0.14);
    --shadow-2: 0 8px 22px rgba(0,0,0,0.10);
    --lift: 0 10px 20px rgba(0,0,0,0.12);
  }
}

* { box-sizing: border-box; }
html, body { height: 100%; }

body {
  margin: 0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  color: var(--text);
  background:
    radial-gradient(1100px 540px at 18% -10%, var(--page-accent-1) 0%, transparent 70%),
    radial-gradient(980px 520px at 115% 0%, var(--page-accent-2) 0%, transparent 70%),
    var(--page-bg);
  min-height: 100dvh;
  padding: 16px;
  display: grid;
  align-content: start;
  justify-items: center;
  gap: 14px;
}

/* Layout */
.container {
  width: 100%;
  max-width: 980px;
  display: grid;
  gap: 16px;
  grid-template-columns: 1fr;
}
@media (min-width: 820px) {
  .container {
    grid-template-columns: 1fr 0.9fr;
    align-items: start;
  }
}

/* Calculator (onyx) and panels */
.calc,
.panel {
  background: linear-gradient(180deg, var(--calc-bg-1) 0%, var(--calc-bg-2) 100%);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow-1);
  overflow: hidden;
}
.panel { box-shadow: var(--shadow-2); }

/* Screen */
.screen {
  padding: 14px 16px 12px;
  border-bottom: 1px solid var(--border);
  display: grid;
  gap: 10px;
}

.mini {
  min-height: 18px;
  color: var(--muted);
  font-size: 13px;
  letter-spacing: 0.2px;
  text-align: right;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* Distinct display window */
.display {
  font-variant-numeric: tabular-nums;
  font-size: clamp(28px, 6.2vw, 40px);
  text-align: right;
  line-height: 1.25;
  padding: 12px 14px;
  background:
    radial-gradient(80% 70% at 85% 25%, var(--display-glow), transparent 60%),
    var(--display-bg);
  border: 1px solid var(--display-border);
  border-radius: 12px;
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.04);
  word-break: break-word;
}

.mem-indicator {
  text-align: right;
  color: var(--muted);
  font-size: 12px;
  min-height: 16px;
}

/* Keys grid */
.keys {
  padding: 12px;
  display: grid;
  grid-template-columns: repeat(4, minmax(0, 1fr));
  gap: var(--gap);
  grid-auto-rows: clamp(48px, 6.8vw, 56px); /* uniform heights */
}

/* Base key style (digits) */
button.key {
  appearance: none;
  border: 1px solid var(--key-border);
  background: var(--key-bg);
  color: var(--text);
  border-radius: 12px;
  font-size: 16px;
  font-weight: 600;
  line-height: 1;
  height: 100%;
  display: grid;
  place-items: center;
  user-select: none;
  cursor: pointer;
  transition:
    background-color 0.18s ease,
    border-color 0.18s ease,
    box-shadow 0.18s ease,
    transform 0.04s ease,
    filter 0.18s ease;
}
button.key:hover { background: var(--key-hover); box-shadow: var(--lift); }
button.key:active { transform: translateY(1px) scale(0.997); }
button.key:focus-visible { outline: none; box-shadow: var(--focus); }

/* Memory keys (onyx variant) */
.key.mem {
  background: var(--mem-bg);
  border-color: var(--mem-border);
}
.key.mem:hover { background: var(--mem-hover); }

/* Utility keys (±, %) */
.key.util {
  background: var(--util-bg);
  border-color: var(--util-border);
}
.key.util:hover { background: var(--util-hover); }

/* Operator column (terracotta-tinted dark) */
.key.op {
  background: var(--op-bg);
  border-color: var(--op-border);
  color: var(--op-text);
}
.key.op:hover { background: var(--op-hover); box-shadow: var(--lift); }

/* Clear key (terracotta-tinted) */
.key.clear {
  background: var(--clear-bg);
  border-color: var(--clear-border);
  color: var(--clear-text);
}
.key.clear:hover { background: var(--clear-hover); box-shadow: var(--lift); }

/* Equals key (terracotta gradient) */
.key.equals {
  background: linear-gradient(180deg, var(--equals-grad-1), var(--equals-grad-2));
  border-color: transparent;
  color: #fff;
}
.key.equals:hover { filter: brightness(1.05); box-shadow: var(--lift); }
.key.equals:active { transform: translateY(1px) scale(0.997); }

/* 0 spans two columns */
.key.span-2 { grid-column: span 2; }

/* History (onyx with subtle terracotta cues) */
.panel-header {
  padding: 10px 14px;
  border-bottom: 1px solid var(--border);
  font-weight: 700;
  letter-spacing: 0.3px;
  color: #ffd8cd;
}

.history { max-height: 520px; overflow: auto; }

.hist-list {
  list-style: none;
  margin: 0;
  padding: 10px;
  display: grid;
  gap: 8px;
}

.hist-item {
  padding: 10px 12px;
  border: 1px dashed var(--onyx-600);
  border-radius: 10px;
  background: rgba(224, 122, 95, 0.04); /* terracotta wash */
  display: grid;
  gap: 4px;
  cursor: pointer;
  transition: background-color 0.15s ease, border-color 0.15s ease, box-shadow 0.18s ease;
}
.hist-item:hover {
  background: rgba(224, 122, 95, 0.08);
  box-shadow: var(--lift);
}
.hist-expr {
  color: var(--muted);
  font-size: 13px;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}
.hist-res { font-variant-numeric: tabular-nums; font-weight: 700; color: #ffece5; }

/* Footer */
.footer {
  color: var(--muted);
  font-size: 12px;
  text-align: center;
  margin-top: 2px;
  opacity: 0.95;
}

/* Motion preference */
@media (prefers-reduced-motion: reduce) {
  * { transition: none !important; }
}